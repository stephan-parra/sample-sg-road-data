<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Digital Map Viewer</title>

    <!-- MapLibre & Turf.js -->
    <script src="https://cdn.jsdelivr.net/npm/maplibre-gl@2.4.0/dist/maplibre-gl.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/maplibre-gl/dist/maplibre-gl.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@turf/turf/turf.min.js"></script>

    <!-- Mapbox Draw for Polygon Selection -->
    <link href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.0/mapbox-gl-draw.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.0/mapbox-gl-draw.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500&display=swap" rel="stylesheet">

    <!-- jsPDF & html2canvas for PDF Export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>


    <!-- Custom CSS -->
    <link href="styles.css" rel="stylesheet">
</head>

<body>

    <!-- Map Container -->
    <div id="map"></div>

    <!-- Floating Sidebar -->
    <div class="sidebar">
        <h2>Map Controls</h2>
        <label><input type="checkbox" id="toggle-asset-points" checked> Substations (Source: central repo)</label>
        <label><input type="checkbox" id="toggle-roads" checked> Low Voltage Network (Source: central repo)</label>
        <label><input type="checkbox" id="toggle-high-voltage" checked> High Voltage Network (Source: central repo)</label>
        <label><input type="checkbox" id="toggle-traffic-assets" checked> Traffic Assets (Source: api.data.gov.sg)</label>
        
        <button id="draw-polygon">Select and Download LV Network</button>
        <button id="reset-map">Reset Map</button>
    </div>

    <!-- Scale Selector Panel -->
    <div class="scale-panel">
        <h2>Map Scale</h2>
        <select id="scale-select">
            <option value="250">1:250</option>
            <option value="500">1:500</option>
            <option value="1250">1:1250</option>
            <option value="2500">1:2500</option>
            <option value="5000">1:5000</option>
        </select>
    </div>

    <!-- Instructions for Drawing -->
    <div id="draw-instructions" class="map-instructions">Click to draw a polygon, double-click to finish</div>

    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="loader"></div>
        <p>Preparing to download data...</p>
    </div>

    <!-- Custom JavaScript -->
    <script src="map.js"></script>

</body>
</html>
